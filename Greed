local entityModel = true
local latestRoom = game.ReplicatedStorage.GameData.LatestRoom.Value

if game.Workspace:FindFirstChild("SeekMovingNewClone") or 
   latestRoom == 50 or latestRoom == 100 or  
   (latestRoom >= 90 and latestRoom <= 100) then
    entityModel = false
end

if not entityModel then return end

-- Phát âm thanh cảnh báo trước
-- (Bạn có thể thêm âm cảnh báo ở đây nếu muốn)

-- Đợi đến khi vào phòng mới
local initialRoom = latestRoom
game.ReplicatedStorage.GameData.LatestRoom:GetPropertyChangedSignal("Value"):Wait()
while game.ReplicatedStorage.GameData.LatestRoom.Value <= initialRoom do
    task.wait()
end

-- Spawn thực thể
local depthsTer = game:GetObjects("rbxassetid://86489673587623")[1]
depthsTer.Name = "Twiter"
depthsTer.Parent = workspace

local part = depthsTer:FindFirstChildWhichIsA("BasePart") or depthsTer:FindFirstChildWhichIsA("Part")
part.CFrame = game.Workspace.CurrentRooms:GetChildren()[#game.Workspace.CurrentRooms:GetChildren() - 1].Parts.Floor.CFrame + Vector3.new(0, 6, 0)

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid")
local HRP = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")

local lastPos = HRP.Position
local Kill = true
local damageInterval = 0.7
local damageAmount = 10
local activeTime = 5

-- Coroutine gây sát thương nếu người chơi di chuyển
coroutine.wrap(function()
    local elapsedTime = 0
    while elapsedTime < activeTime do
        task.wait(damageInterval)
        local currentPos = HRP.Position
        if (currentPos - lastPos).Magnitude > 0.5 then
            require(LocalPlayer.PlayerGui.MainUI.Initiator.Main_Game).caption("", true)

            if Humanoid then
                Humanoid.Health -= damageAmount

                -- Jumpscare GUI mỗi lần bị sát thương
                task.spawn(function()
                    local TweenService = game:GetService("TweenService")

                    local JumpscareGui = Instance.new("ScreenGui")
                    JumpscareGui.Name = "JumpscareGui"
                    JumpscareGui.IgnoreGuiInset = true
                    JumpscareGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
                    JumpscareGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

                    local Background = Instance.new("Frame")
                    Background.BackgroundColor3 = Color3.fromRGB(3, 25, 99)
                    Background.Size = UDim2.new(1, 0, 1, 0)
                    Background.ZIndex = 999
                    Background.Parent = JumpscareGui

                    local Overlay = Instance.new("ImageLabel")
                    Overlay.BackgroundTransparency = 1
                    Overlay.Size = UDim2.new(1, 0, 1, 0)
                    Overlay.Image = "rbxassetid://93477339710496"
                    Overlay.ZIndex = 998
                    Overlay.Parent = Background

                    local Face = Instance.new("ImageLabel")
                    Face.AnchorPoint = Vector2.new(0.5, 0.5)
                    Face.BackgroundTransparency = 1
                    Face.Position = UDim2.new(0.5, 0, 0.5, 0)
                    Face.Size = UDim2.new(0, 300, 0, 150)
                    Face.Image = "rbxassetid://17273648129"
                    Face.ZIndex = 1000
                    Face.Parent = Background

                    local scare = Instance.new("Sound")
                    scare.SoundId = "rbxassetid://6754147732"
                    scare.Volume = 10
                    scare.Parent = JumpscareGui
                    scare:Play()

                    task.spawn(function()
                        while JumpscareGui.Parent do
                            Background.BackgroundColor3 = Color3.fromRGB(3, 25, 99)
                            task.wait(math.random(25, 100) / 1000)
                            Background.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                            task.wait(math.random(25, 100) / 1000)
                        end
                    end)

                    local overlayImages = {
                        "rbxassetid://93477339710496",
                        "rbxassetid://82216621528642"
                    }
                    task.spawn(function()
                        local i = 1
                        while JumpscareGui.Parent do
                            Overlay.Image = overlayImages[i]
                            i = i % #overlayImages + 1
                            task.wait(0.07)
                        end
                    end)

                    local function tweenTo(object, props, time)
                        local tween = TweenService:Create(object, TweenInfo.new(time, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), props)
                        tween:Play()
                        return tween
                    end

                    local function getRandomNearCenterPosition()
                        local offsetX = (math.random(-6, 6) / 100)
                        local offsetY = (math.random(-6, 6) / 100)
                        if math.abs(offsetX) < 0.01 then
                            offsetX = 0.015 * (math.random(0, 1) == 0 and -1 or 1)
                        end
                        if math.abs(offsetY) < 0.01 then
                            offsetY = 0.015 * (math.random(0, 1) == 0 and -1 or 1)
                        end
                        return UDim2.new(0.5 + offsetX, 0, 0.5 + offsetY, 0)
                    end

                    local duration = 1
                    local enlargeTween = tweenTo(Face, {
                        Size = UDim2.new(3, 0, 2.5, 0),
                        ImageTransparency = 0,
                    }, duration)

                    local startTime = tick()
                    while tick() - startTime < duration do
                        Face.Position = getRandomNearCenterPosition()
                        task.wait(0.05)
                    end
                    enlargeTween.Completed:Wait()

                    tweenTo(Face, {
                        Size = UDim2.new(0.1, 0, 0.1, 0),
                        Position = UDim2.new(0.5, 0, 0.5, 0)
                    }, 0.1)

                    task.delay(1.5, function()
                        JumpscareGui:Destroy()
                    end)
                end)

                if Humanoid.Health <= 0 then
                    -- Death hint
                    local func, setupval, getinfo, typeof, getgc, next = nil, debug.setupvalue or setupvalue, debug.getinfo or getinfo, typeof, getgc, next
                    for i, v in next, getgc(false) do
                        if typeof(v) == "function" then
                            local info = getinfo(v)
                            if info.currentline == 54 and info.nups == 2 and info.is_vararg == 0 then
                                func = v
                                break
                            end
                        end
                    end

                    local function DeathHint(hints, type)
                        setupval(func, 1, hints)
                        if type ~= nil then
                            setupval(func, 2, type)
                        end
                    end

                    DeathHint({
                        "You died to Greed.",
                        "It punishes movement.",
                        "When you hear the warning, freeze.",
                        "Standing still might save your life."
                    }, "Blue")
                end
            end

            lastPos = currentPos
        end

        elapsedTime += damageInterval
    end

    Kill = false
    depthsTer:Destroy()

    -- Achievement
    local achievementGiver = loadstring(game:HttpGet("https://raw.githubusercontent.com/RegularVynixu/Utilities/main/Doors/Custom%20Achievements/Source.lua"))()
    achievementGiver({
        Title = "Stop moving",
        Desc = "Shut up and rage quit",
        Reason = "Encounter Greed",
        Image = "rbxassetid://11498874173"
    })
end)()

loadstring(game:HttpGet("https://raw.githubusercontent.com/eoyoustme2/Endless/refs/heads/main/Greed%20moving"))()
