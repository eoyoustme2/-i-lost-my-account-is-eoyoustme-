-- Load Spawner
local spawner = loadstring(game:HttpGet("https://raw.githubusercontent.com/RegularVynixu/Utilities/main/Doors/Entity%20Spawner/V2/Source.lua"))()

-- Hàm tải và phát âm thanh từ GitHub
local function GitAud(soundgit, filename)
	writefile(filename..".mp3", game:HttpGet(soundgit))
	return (getcustomasset or getsynasset)(filename..".mp3")
end

local function CustomGitSound(soundlink, vol, filename)
	local sound = Instance.new("Sound", workspace)
	sound.SoundId = GitAud(soundlink, filename)
	sound.Volume = vol or 1
	sound:Play()
end

-- Chạy Rebound mỗi khi người chơi qua phòng, tối đa 3 lần
local spawnCount = 0
local maxSpawns = 3

game.ReplicatedStorage.GameData.LatestRoom.Changed:Connect(function()
	if spawnCount >= maxSpawns then return end
	spawnCount += 1

	-- Tạo entity Rebound
	local entity = spawner.Create({
		Entity = {
			Name = "Rebound",
			Asset = "rbxassetid://13499570750",
			HeightOffset = 0
		},
		Lights = {
			Flicker = { Enabled = true, Duration = 1 },
			Shatter = true,
			Repair = false
		},
		Earthquake = { Enabled = true },
		CameraShake = {
			Enabled = true,
			Range = 100,
			Values = {1.5, 20, 0.1, 1}
		},
		Movement = {
			Speed = 230,
			Delay = 2,
			Reversed = true
		},
		Rebounding = {
			Enabled = true,
			Type = "Ambush",
			Min = 1,
			Max = 1,
			Delay = 0.01
		},
		Damage = {
			Enabled = true,
			Range = 40,
			Amount = 125
		},
		Crucifixion = {
			Enabled = true,
			Range = 40,
			Resist = false,
			Break = true
		},
		Death = {
			Type = "Guiding",
			Hints = {"Death", "Hints", "Go", "Here"},
			Cause = ""
		}
	})

	-- Callbacks
	entity:SetCallback("OnSpawned", function()
		print("Entity has spawned")

		local effect = Instance.new("ColorCorrectionEffect", game.Lighting)
		effect.Name = "Warn"
		effect.TintColor = Color3.fromRGB(61, 171, 98)
		effect.Saturation = -0.7
		effect.Contrast = 0.2
		game.Debris:AddItem(effect, 24)

		game.TweenService:Create(effect, TweenInfo.new(15), {
			TintColor = Color3.fromRGB(255, 255, 255),
			Saturation = 0,
			Contrast = 0
		}):Play()

		local success, CameraShaker = pcall(function()
			return require(game.ReplicatedStorage:WaitForChild("CameraShaker"))
		end)

		if success then
			local cam = workspace.CurrentCamera
			local shake = CameraShaker.new(Enum.RenderPriority.Camera.Value, function(shakeCf)
				cam.CFrame = cam.CFrame * shakeCf
			end)
			shake:Start()
			shake:ShakeOnce(10, 3, 0.1, 6, 2, 0.5)
		end

		wait(0.5)
		CustomGitSound(
			"https://github.com/Kotyara19k-Doorsspawner/Random-files/raw/main/Y2meta.app%20-%20DOORS%20HARDCORE_REBOUND%20MOVING%20START%20(320%20kbps).mp3",
			2,
			"ReboundMoving"
		)
	end)

	entity:SetCallback("OnDespawned", function()
		print("Entity has despawned")
	end)

	-- Chạy entity
	entity:Run()
end)
